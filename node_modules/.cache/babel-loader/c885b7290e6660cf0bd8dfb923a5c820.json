{"ast":null,"code":"/**\n * ag-grid-community - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components\n * @version v21.1.0\n * @link http://www.ag-grid.com/\n * @license MIT\n */\n\"use strict\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar eventService_1 = require(\"../eventService\");\n\nvar gridOptionsWrapper_1 = require(\"../gridOptionsWrapper\");\n\nvar context_1 = require(\"./context\");\n\nvar utils_1 = require(\"../utils\");\n\nvar BeanStub =\n/** @class */\nfunction () {\n  function BeanStub() {\n    this.destroyFunctions = [];\n    this.destroyed = false;\n  } // this was a test constructor niall built, when active, it prints after 5 seconds all beans/components that are\n  // not destroyed. to use, create a new grid, then api.destroy() before 5 seconds. then anything that gets printed\n  // points to a bean or component that was not properly disposed of.\n  // constructor() {\n  //     setTimeout(()=> {\n  //         if (this.isAlive()) {\n  //             let prototype: any = Object.getPrototypeOf(this);\n  //             const constructor: any = prototype.constructor;\n  //             const constructorString = constructor.toString();\n  //             const beanName = constructorString.substring(9, constructorString.indexOf(\"(\"));\n  //             console.log('is alive ' + beanName);\n  //         }\n  //     }, 5000);\n  // }\n  // CellComp and GridComp and override this because they get the FrameworkOverrides from the Beans bean\n\n\n  BeanStub.prototype.getFrameworkOverrides = function () {\n    return this.frameworkOverrides;\n  };\n\n  BeanStub.prototype.getContext = function () {\n    return this.context;\n  };\n\n  BeanStub.prototype.destroy = function () {\n    // let prototype: any = Object.getPrototypeOf(this);\n    // const constructor: any = prototype.constructor;\n    // const constructorString = constructor.toString();\n    // const beanName = constructorString.substring(9, constructorString.indexOf(\"(\"));\n    this.destroyFunctions.forEach(function (func) {\n      return func();\n    });\n    this.destroyFunctions.length = 0;\n    this.destroyed = true;\n    this.dispatchEvent({\n      type: BeanStub.EVENT_DESTROYED\n    });\n  };\n\n  BeanStub.prototype.addEventListener = function (eventType, listener) {\n    if (!this.localEventService) {\n      this.localEventService = new eventService_1.EventService();\n    }\n\n    this.localEventService.addEventListener(eventType, listener);\n  };\n\n  BeanStub.prototype.removeEventListener = function (eventType, listener) {\n    if (this.localEventService) {\n      this.localEventService.removeEventListener(eventType, listener);\n    }\n  };\n\n  BeanStub.prototype.dispatchEventAsync = function (event) {\n    var _this = this;\n\n    window.setTimeout(function () {\n      return _this.dispatchEvent(event);\n    }, 0);\n  };\n\n  BeanStub.prototype.dispatchEvent = function (event) {\n    if (this.localEventService) {\n      this.localEventService.dispatchEvent(event);\n    }\n  };\n\n  BeanStub.prototype.addDestroyableEventListener = function (eElement, event, listener) {\n    var _this = this;\n\n    if (this.destroyed) {\n      return;\n    }\n\n    if (eElement instanceof HTMLElement) {\n      utils_1._.addSafePassiveEventListener(this.getFrameworkOverrides(), eElement, event, listener);\n    } else if (eElement instanceof Window) {\n      eElement.addEventListener(event, listener);\n    } else if (eElement instanceof gridOptionsWrapper_1.GridOptionsWrapper) {\n      eElement.addEventListener(event, listener);\n    } else {\n      eElement.addEventListener(event, listener);\n    }\n\n    var destroyFunc = function () {\n      if (eElement instanceof HTMLElement) {\n        eElement.removeEventListener(event, listener);\n      } else if (eElement instanceof Window) {\n        eElement.removeEventListener(event, listener);\n      } else if (eElement instanceof gridOptionsWrapper_1.GridOptionsWrapper) {\n        eElement.removeEventListener(event, listener);\n      } else {\n        eElement.removeEventListener(event, listener);\n      }\n\n      _this.destroyFunctions = _this.destroyFunctions.filter(function (fn) {\n        return fn !== destroyFunc;\n      });\n    };\n\n    this.destroyFunctions.push(destroyFunc);\n    return destroyFunc;\n  };\n\n  BeanStub.prototype.isAlive = function () {\n    return !this.destroyed;\n  };\n\n  BeanStub.prototype.addDestroyFunc = function (func) {\n    // if we are already destroyed, we execute the func now\n    if (this.isAlive()) {\n      this.destroyFunctions.push(func);\n    } else {\n      func();\n    }\n  };\n\n  BeanStub.EVENT_DESTROYED = 'destroyed';\n\n  __decorate([context_1.Autowired('context'), __metadata(\"design:type\", context_1.Context)], BeanStub.prototype, \"context\", void 0);\n\n  __decorate([context_1.Autowired('frameworkOverrides'), __metadata(\"design:type\", Object)], BeanStub.prototype, \"frameworkOverrides\", void 0);\n\n  __decorate([context_1.PreDestroy, __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", []), __metadata(\"design:returntype\", void 0)], BeanStub.prototype, \"destroy\", null);\n\n  return BeanStub;\n}();\n\nexports.BeanStub = BeanStub;","map":null,"metadata":{},"sourceType":"script"}